"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.ParseGraphQLServer = void 0;

var _cors = _interopRequireDefault(require("cors"));

var _bodyParser = _interopRequireDefault(require("body-parser"));

var _graphqlUpload = require("graphql-upload");

var _expressApollo = require("apollo-server-express/dist/expressApollo");

var _graphqlPlaygroundHtml = require("@apollographql/graphql-playground-html");

var _graphql = require("graphql");

var _subscriptionsTransportWs = require("subscriptions-transport-ws");

var _middlewares = require("../middlewares");

var _requiredParameter = _interopRequireDefault(require("../requiredParameter"));

var _logger = _interopRequireDefault(require("../logger"));

var _ParseGraphQLSchema = require("./ParseGraphQLSchema");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

class ParseGraphQLServer {
  constructor(parseServer, config) {
    this.parseServer = parseServer || (0, _requiredParameter.default)('You must provide a parseServer instance!');

    if (!config || !config.graphQLPath) {
      (0, _requiredParameter.default)('You must provide a config.graphQLPath!');
    }

    this.config = config;
    this.parseGraphQLSchema = new _ParseGraphQLSchema.ParseGraphQLSchema(this.parseServer.config.databaseController, this.parseServer.config && this.parseServer.config.loggerController || _logger.default);
  }

  async _getGraphQLOptions(req) {
    return {
      schema: await this.parseGraphQLSchema.load(),
      context: {
        info: req.info,
        config: req.config,
        auth: req.auth
      }
    };
  }

  applyGraphQL(app) {
    if (!app || !app.use) {
      (0, _requiredParameter.default)('You must provide an Express.js app instance!');
    }

    const maxUploadSize = this.parseServer.config.maxUploadSize || '20mb';
    const maxFileSize = Number(maxUploadSize.slice(0, -2)) * 1024 ^ {
      kb: 1,
      mb: 2,
      gb: 3
    }[maxUploadSize.slice(-2).toLowerCase()];
    app.use(this.config.graphQLPath, (0, _graphqlUpload.graphqlUploadExpress)({
      maxFileSize
    }));
    app.use(this.config.graphQLPath, (0, _cors.default)());
    app.use(this.config.graphQLPath, _bodyParser.default.json());
    app.use(this.config.graphQLPath, _middlewares.handleParseHeaders);
    app.use(this.config.graphQLPath, (0, _expressApollo.graphqlExpress)(async req => await this._getGraphQLOptions(req)));
  }

  applyPlayground(app) {
    if (!app || !app.get) {
      (0, _requiredParameter.default)('You must provide an Express.js app instance!');
    }

    app.get(this.config.playgroundPath || (0, _requiredParameter.default)('You must provide a config.playgroundPath to applyPlayground!'), (_req, res) => {
      res.setHeader('Content-Type', 'text/html');
      res.write((0, _graphqlPlaygroundHtml.renderPlaygroundPage)({
        endpoint: this.config.graphQLPath,
        subscriptionEndpoint: this.config.subscriptionsPath,
        headers: {
          'X-Parse-Application-Id': this.parseServer.config.appId,
          'X-Parse-Master-Key': this.parseServer.config.masterKey
        }
      }));
      res.end();
    });
  }

  createSubscriptions(server) {
    _subscriptionsTransportWs.SubscriptionServer.create({
      execute: _graphql.execute,
      subscribe: _graphql.subscribe,
      onOperation: async (_message, params, webSocket) => Object.assign({}, params, (await this._getGraphQLOptions(webSocket.upgradeReq)))
    }, {
      server,
      path: this.config.subscriptionsPath || (0, _requiredParameter.default)('You must provide a config.subscriptionsPath to createSubscriptions!')
    });
  }

}

exports.ParseGraphQLServer = ParseGraphQLServer;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9HcmFwaFFML1BhcnNlR3JhcGhRTFNlcnZlci5qcyJdLCJuYW1lcyI6WyJQYXJzZUdyYXBoUUxTZXJ2ZXIiLCJjb25zdHJ1Y3RvciIsInBhcnNlU2VydmVyIiwiY29uZmlnIiwiZ3JhcGhRTFBhdGgiLCJwYXJzZUdyYXBoUUxTY2hlbWEiLCJQYXJzZUdyYXBoUUxTY2hlbWEiLCJkYXRhYmFzZUNvbnRyb2xsZXIiLCJsb2dnZXJDb250cm9sbGVyIiwiZGVmYXVsdExvZ2dlciIsIl9nZXRHcmFwaFFMT3B0aW9ucyIsInJlcSIsInNjaGVtYSIsImxvYWQiLCJjb250ZXh0IiwiaW5mbyIsImF1dGgiLCJhcHBseUdyYXBoUUwiLCJhcHAiLCJ1c2UiLCJtYXhVcGxvYWRTaXplIiwibWF4RmlsZVNpemUiLCJOdW1iZXIiLCJzbGljZSIsImtiIiwibWIiLCJnYiIsInRvTG93ZXJDYXNlIiwiYm9keVBhcnNlciIsImpzb24iLCJoYW5kbGVQYXJzZUhlYWRlcnMiLCJhcHBseVBsYXlncm91bmQiLCJnZXQiLCJwbGF5Z3JvdW5kUGF0aCIsIl9yZXEiLCJyZXMiLCJzZXRIZWFkZXIiLCJ3cml0ZSIsImVuZHBvaW50Iiwic3Vic2NyaXB0aW9uRW5kcG9pbnQiLCJzdWJzY3JpcHRpb25zUGF0aCIsImhlYWRlcnMiLCJhcHBJZCIsIm1hc3RlcktleSIsImVuZCIsImNyZWF0ZVN1YnNjcmlwdGlvbnMiLCJzZXJ2ZXIiLCJTdWJzY3JpcHRpb25TZXJ2ZXIiLCJjcmVhdGUiLCJleGVjdXRlIiwic3Vic2NyaWJlIiwib25PcGVyYXRpb24iLCJfbWVzc2FnZSIsInBhcmFtcyIsIndlYlNvY2tldCIsIk9iamVjdCIsImFzc2lnbiIsInVwZ3JhZGVSZXEiLCJwYXRoIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7Ozs7QUFFQSxNQUFNQSxrQkFBTixDQUF5QjtB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QixXQUE5QjtBQUNBRCxNQUFBQSxHQUFHLENBQUNFLEtBQUosQ0FDRSxpREFBcUI7QUFDbkJDLFFBQUFBLFFBQVEsRUFBRSxLQUFLbkMsTUFBTCxDQUFZQyxXQURIO0FBRW5CbUMsUUFBQUEsb0JBQW9CLEVBQUUsS0FBS3BDLE1BQUwsQ0FBWXFDLGlCQUZmO0FBR25CQyxRQUFBQSxPQUFPLEVBQUU7QUFDUCxvQ0FBMEIsS0FBS3ZDLFdBQUwsQ0FBaUJDLE1BQWpCLENBQXdCdUMsS0FEM0M7QUFFUCxnQ0FBc0IsS0FBS3hDLFdBQUwsQ0FBaUJDLE1BQWpCLENBQXdCd0M7QUFGdkM7QUFIVSxPQUFyQixDQURGO0FBVUFSLE1BQUFBLEdBQUcsQ0FBQ1MsR0FBSjtBQUNELEtBbEJIO0FBb0JEOztBQUVEQyxFQUFBQSxtQkFBbUIsQ0FBQ0MsTUFBRCxFQUFTO0FBQzFCQyxpREFBbUJDLE1BQW5CLENBQ0U7QUFDRUMsTUFBQUEsT0FBTyxFQUFQQSxnQkFERjtBQUVFQyxNQUFBQSxTQUFTLEVBQVRBLGtCQUZGO0FBR0VDLE1BQUFBLFdBQVcsRUFBRSxPQUFPQyxRQUFQLEVBQWlCQyxNQUFqQixFQUF5QkMsU0FBekIsS0FDWEMsTUFBTSxDQUFDQyxNQUFQLENBQ0UsRUFERixFQUVFSCxNQUZGLEdBR0UsTUFBTSxLQUFLM0Msa0JBQUwsQ0FBd0I0QyxTQUFTLENBQUNHLFVBQWxDLENBSFI7QUFKSixLQURGLEVBV0U7QUFDRVgsTUFBQUEsTUFERjtBQUVFWSxNQUFBQSxJQUFJLEVBQ0YsS0FBS3ZELE1BQUwsQ0FBWXFDLGlCQUFaLElBQ0EsZ0NBQ0UscUVBREY7QUFKSixLQVhGO0FBb0JEOztBQWxHc0IiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgY29yc01pZGRsZXdhcmUgZnJvbSAnY29ycyc7XG5pbXBvcnQgYm9keVBhcnNlciBmcm9tICdib2R5LXBhcnNlcic7XG5pbXBvcnQgeyBncmFwaHFsVXBsb2FkRXhwcmVzcyB9IGZyb20gJ2dyYXBocWwtdXBsb2FkJztcbmltcG9ydCB7IGdyYXBocWxFeHByZXNzIH0gZnJvbSAnYXBvbGxvLXNlcnZlci1leHByZXNzL2Rpc3QvZXhwcmVzc0Fwb2xsbyc7XG5pbXBvcnQgeyByZW5kZXJQbGF5Z3JvdW5kUGFnZSB9IGZyb20gJ0BhcG9sbG9ncmFwaHFsL2dyYXBocWwtcGxheWdyb3VuZC1odG1sJztcbmltcG9ydCB7IGV4ZWN1dGUsIHN1YnNjcmliZSB9IGZyb20gJ2dyYXBocWwnO1xuaW1wb3J0IHsgU3Vic2NyaXB0aW9uU2VydmVyIH0gZnJvbSAnc3Vic2NyaXB0aW9ucy10cmFuc3BvcnQtd3MnO1xuaW1wb3J0IHsgaGFuZGxlUGFyc2VIZWFkZXJzIH0gZnJvbSAnLi4vbWlkZGxld2FyZXMnO1xuaW1wb3J0IHJlcXVpcmVkUGFyYW1ldGVyIGZyb20gJy4uL3JlcXVpcmVkUGFyYW1ldGVyJztcbmltcG9ydCBkZWZhdWx0TG9nZ2VyIGZyb20gJy4uL2xvZ2dlcic7XG5pbXBvcnQgeyBQYXJzZUdyYXBoUUxTY2hlbWEgfSBmcm9tICcuL1BhcnNlR3JhcGhRTFNjaGVtYSc7XG5cbmNsYXNzIFBhcnNlR3JhcGhRTFNlcnZlciB7XG4gIGNvbnN0cnVjdG9yKHBhcnNlU2VydmVyLCBjb25maWcpIHtcbiAgICB0aGlzLnBhcnNlU2VydmVyID1cbiAgICAgIHBhcnNlU2VydmVyIHx8XG4gICAgICByZXF1aXJlZFBhcmFtZXRlcignWW91IG11c3QgcHJvdmlkZSBhIHBhcnNlU2VydmVyIGluc3RhbmNlIScpO1xuICAgIGlmICghY29uZmlnIHx8ICFjb25maWcuZ3JhcGhRTFBhdGgpIHtcbiAgICAgIHJlcXVpcmVkUGFyYW1ldGVyKCdZb3UgbXVzdCBwcm92aWRlIGEgY29uZmlnLmdyYXBoUUxQYXRoIScpO1xuICAgIH1cbiAgICB0aGlzLmNvbmZpZyA9IGNvbmZpZztcbiAgICB0aGlzLnBhcnNlR3JhcGhRTFNjaGVtYSA9IG5ldyBQYXJzZUdyYXBoUUxTY2hlbWEoXG4gICAgICB0aGlzLnBhcnNlU2VydmVyLmNvbmZpZy5kYXRhYmFzZUNvbnRyb2xsZXIsXG4gICAgICAodGhpcy5wYXJzZVNlcnZlci5jb25maWcgJiYgdGhpcy5wYXJzZVNlcnZlci5jb25maWcubG9nZ2VyQ29udHJvbGxlcikgfHxcbiAgICAgICAgZGVmYXVsdExvZ2dlclxuICAgICk7XG4gIH1cblxuICBhc3luYyBfZ2V0R3JhcGhRTE9wdGlvbnMocmVxKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHNjaGVtYTogYXdhaXQgdGhpcy5wYXJzZUdyYXBoUUxTY2hlbWEubG9hZCgpLFxuICAgICAgY29udGV4dDoge1xuICAgICAgICBpbmZvOiByZXEuaW5mbyxcbiAgICAgICAgY29uZmlnOiByZXEuY29uZmlnLFxuICAgICAgICBhdXRoOiByZXEuYXV0aCxcbiAgICAgIH0sXG4gICAgfTtcbiAgfVxuXG4gIGFwcGx5R3JhcGhRTChhcHApIHtcbiAgICBpZiAoIWFwcCB8fCAhYXBwLnVzZSkge1xuICAgICAgcmVxdWlyZWRQYXJhbWV0ZXIoJ1lvdSBtdXN0IHByb3ZpZGUgYW4gRXhwcmVzcy5qcyBhcHAgaW5zdGFuY2UhJyk7XG4gICAgfVxuXG4gICAgY29uc3QgbWF4VXBsb2FkU2l6ZSA9IHRoaXMucGFyc2VTZXJ2ZXIuY29uZmlnLm1heFVwbG9hZFNpemUgfHwgJzIwbWInO1xuICAgIGNvbnN0IG1heEZpbGVTaXplID1cbiAgICAgIChOdW1iZXIobWF4VXBsb2FkU2l6ZS5zbGljZSgwLCAtMikpICogMTAyNCkgXlxuICAgICAge1xuICAgICAgICBrYjogMSxcbiAgICAgICAgbWI6IDIsXG4gICAgICAgIGdiOiAzLFxuICAgICAgfVttYXhVcGxvYWRTaXplLnNsaWNlKC0yKS50b0xvd2VyQ2FzZSgpXTtcblxuICAgIGFwcC51c2UodGhpcy5jb25maWcuZ3JhcGhRTFBhdGgsIGdyYXBocWxVcGxvYWRFeHByZXNzKHsgbWF4RmlsZVNpemUgfSkpO1xuICAgIGFwcC51c2UodGhpcy5jb25maWcuZ3JhcGhRTFBhdGgsIGNvcnNNaWRkbGV3YXJlKCkpO1xuICAgIGFwcC51c2UodGhpcy5jb25maWcuZ3JhcGhRTFBhdGgsIGJvZHlQYXJzZXIuanNvbigpKTtcbiAgICBhcHAudXNlKHRoaXMuY29uZmlnLmdyYXBoUUxQYXRoLCBoYW5kbGVQYXJzZUhlYWRlcnMpO1xuICAgIGFwcC51c2UoXG4gICAgICB0aGlzLmNvbmZpZy5ncmFwaFFMUGF0aCxcbiAgICAgIGdyYXBocWxFeHByZXNzKGFzeW5jIHJlcSA9PiBhd2FpdCB0aGlzLl9nZXRHcmFwaFFMT3B0aW9ucyhyZXEpKVxuICAgICk7XG4gIH1cblxuICBhcHBseVBsYXlncm91bmQoYXBwKSB7XG4gICAgaWYgKCFhcHAgfHwgIWFwcC5nZXQpIHtcbiAgICAgIHJlcXVpcmVkUGFyYW1ldGVyKCdZb3UgbXVzdCBwcm92aWRlIGFuIEV4cHJlc3MuanMgYXBwIGluc3RhbmNlIScpO1xuICAgIH1cbiAgICBhcHAuZ2V0KFxuICAgICAgdGhpcy5jb25maWcucGxheWdyb3VuZFBhdGggfHxcbiAgICAgICAgcmVxdWlyZWRQYXJhbWV0ZXIoXG4gICAgICAgICAgJ1lvdSBtdXN0IHByb3ZpZGUgYSBjb25maWcucGxheWdyb3VuZFBhdGggdG8gYXBwbHlQbGF5Z3JvdW5kISdcbiAgICAgICAgKSxcbiAgICAgIChfcmVxLCByZXMpID0+IHtcbiAgICAgICAgcmVzLnNldEhlYWRlcignQ29udGVudC1UeXBlJywgJ3RleHQvaHRtbCcpO1xuICAgICAgICByZXMud3JpdGUoXG4gICAgICAgICAgcmVuZGVyUGxheWdyb3VuZFBhZ2Uoe1xuICAgICAgICAgICAgZW5kcG9pbnQ6IHRoaXMuY29uZmlnLmdyYXBoUUxQYXRoLFxuICAgICAgICAgICAgc3Vic2NyaXB0aW9uRW5kcG9pbnQ6IHRoaXMuY29uZmlnLnN1YnNjcmlwdGlvbnNQYXRoLFxuICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAnWC1QYXJzZS1BcHBsaWNhdGlvbi1JZCc6IHRoaXMucGFyc2VTZXJ2ZXIuY29uZmlnLmFwcElkLFxuICAgICAgICAgICAgICAnWC1QYXJzZS1NYXN0ZXItS2V5JzogdGhpcy5wYXJzZVNlcnZlci5jb25maWcubWFzdGVyS2V5LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9KVxuICAgICAgICApO1xuICAgICAgICByZXMuZW5kKCk7XG4gICAgICB9XG4gICAgKTtcbiAgfVxuXG4gIGNyZWF0ZVN1YnNjcmlwdGlvbnMoc2VydmVyKSB7XG4gICAgU3Vic2NyaXB0aW9uU2VydmVyLmNyZWF0ZShcbiAgICAgIHtcbiAgICAgICAgZXhlY3V0ZSxcbiAgICAgICAgc3Vic2NyaWJlLFxuICAgICAgICBvbk9wZXJhdGlvbjogYXN5bmMgKF9tZXNzYWdlLCBwYXJhbXMsIHdlYlNvY2tldCkgPT5cbiAgICAgICAgICBPYmplY3QuYXNzaWduKFxuICAgICAgICAgICAge30sXG4gICAgICAgICAgICBwYXJhbXMsXG4gICAgICAgICAgICBhd2FpdCB0aGlzLl9nZXRHcmFwaFFMT3B0aW9ucyh3ZWJTb2NrZXQudXBncmFkZVJlcSlcbiAgICAgICAgICApLFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgc2VydmVyLFxuICAgICAgICBwYXRoOlxuICAgICAgICAgIHRoaXMuY29uZmlnLnN1YnNjcmlwdGlvbnNQYXRoIHx8XG4gICAgICAgICAgcmVxdWlyZWRQYXJhbWV0ZXIoXG4gICAgICAgICAgICAnWW91IG11c3QgcHJvdmlkZSBhIGNvbmZpZy5zdWJzY3JpcHRpb25zUGF0aCB0byBjcmVhdGVTdWJzY3JpcHRpb25zISdcbiAgICAgICAgICApLFxuICAgICAgfVxuICAgICk7XG4gIH1cbn1cblxuZXhwb3J0IHsgUGFyc2VHcmFwaFFMU2VydmVyIH07XG4iXX0=